/home/remote/u7177797/git/CLIP-KB
gpusrv-5
Thu Aug 10 01:24:19 AEST 2023
---- CLIP Pretraining ----
/var/spool/slurmd/job43337/slurm_script: line 27: activate: No such file or directory

> Saving model to: saved/models/FB15k-237/pretraining/RGCN/RGCN-gpt2-large_32bs_10e_FB15k-237.pt

> Setting device cuda:0 for computation.
> Loading Pretrained tokenizer.
> Preparing the data.
> Initializing the model.

### EPOCH 0
  0%|          | 0/364 [00:00<?, ?it/s]/home/remote/u7177797/miniconda3/envs/torch/lib/python3.10/site-packages/dgl/backend/pytorch/tensor.py:449: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  assert input.numel() == input.storage().size(), (
  0%|          | 0/364 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/remote/u7177797/git/CLIP-KB/pretraining.py", line 311, in <module>
    _, _, metrics = training_routine(
  File "/home/remote/u7177797/git/CLIP-KB/utils.py", line 79, in training_routine
    loss = step_f(model, batch, label, dev)
  File "/home/remote/u7177797/git/CLIP-KB/pretraining.py", line 208, in step_f
    graph_out, text_out = model(batch['entities'].to(dev), batch['captions'].to(dev))
  File "/home/remote/u7177797/miniconda3/envs/torch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/remote/u7177797/git/CLIP-KB/model.py", line 91, in forward
    captions = self.t_mlp(self.t_encoder(captions))
  File "/home/remote/u7177797/miniconda3/envs/torch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/remote/u7177797/git/CLIP-KB/model.py", line 136, in forward
    return self.model(**x).last_hidden_state[:,-1,:]
  File "/home/remote/u7177797/miniconda3/envs/torch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/remote/u7177797/miniconda3/envs/torch/lib/python3.10/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 900, in forward
    outputs = block(
  File "/home/remote/u7177797/miniconda3/envs/torch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/remote/u7177797/miniconda3/envs/torch/lib/python3.10/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 428, in forward
    feed_forward_hidden_states = self.mlp(hidden_states)
  File "/home/remote/u7177797/miniconda3/envs/torch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/remote/u7177797/miniconda3/envs/torch/lib/python3.10/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 356, in forward
    hidden_states = self.act(hidden_states)
  File "/home/remote/u7177797/miniconda3/envs/torch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/remote/u7177797/miniconda3/envs/torch/lib/python3.10/site-packages/transformers/activations.py", line 56, in forward
    return 0.5 * input * (1.0 + torch.tanh(math.sqrt(2.0 / math.pi) * (input + 0.044715 * torch.pow(input, 3.0))))
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 238.00 MiB (GPU 0; 47.54 GiB total capacity; 46.37 GiB already allocated; 225.88 MiB free; 46.95 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
srun: error: gpusrv-5: task 0: Exited with exit code 1
---- Done ----
Thu Aug 10 01:24:35 AEST 2023
